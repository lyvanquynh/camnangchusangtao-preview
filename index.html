<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Album Preview</title>

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
  user-select:none;
  touch-action:none;
  font-family:Arial,Helvetica,sans-serif;
}

#viewer{
  position:fixed;
  inset:0;
  background:#000;
  overflow:hidden;
}

#slider{
  display:flex;
  height:100%;
  will-change:transform;
  transition:transform .45s cubic-bezier(.4,0,.2,1);
}

.slide{
  width:100vw;
  height:100vh;
  flex-shrink:0;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}

.slide img{
  max-width:100%;
  max-height:100%;
  transform-origin:center center;
  transition:transform .12s ease-out;
  cursor:grab;
}

.slide img:active{cursor:grabbing}

.nav{
  position:fixed;
  top:50%;
  transform:translateY(-50%);
  font-size:48px;
  color:#fff;
  padding:10px 18px;
  cursor:pointer;
  z-index:10;
  opacity:.6;
}
.nav:hover{opacity:1}
#prev{left:0}
#next{right:0}

#close{
  position:fixed;
  top:14px;
  right:18px;
  font-size:28px;
  color:#fff;
  cursor:pointer;
  z-index:10;
  opacity:.7;
}
#close:hover{opacity:1}

#counter{
  position:fixed;
  right:16px;
  bottom:14px;
  color:#fff;
  font-size:14px;
  opacity:.7;
}
</style>
</head>

<body>

<div id="viewer">
  <div id="slider"></div>
</div>

<div id="prev" class="nav">◀</div>
<div id="next" class="nav">▶</div>
<div id="close">✕</div>
<div id="counter"></div>

<script>
/* ================= CONFIG ================= */
const TOTAL = 20
const FOLDER = "images/"
const slider = document.getElementById("slider")
const counter = document.getElementById("counter")

/* ================= STATE ================= */
let index = 0
let scale = 1
let panX = 0
let panY = 0
let isPanning = false
let startX = 0
let startY = 0

/* ================= LOAD IMAGES ================= */
for(let i=1;i<=TOTAL;i++){
  const slide = document.createElement("div")
  slide.className = "slide"

  const img = document.createElement("img")
  img.src = FOLDER + String(i).padStart(2,"0") + ".jpg"

  slide.appendChild(img)
  slider.appendChild(slide)
}

const images = document.querySelectorAll(".slide img")

/* ================= CORE ================= */
function updateSlider(animate=true){
  slider.style.transition = animate
    ? "transform .45s cubic-bezier(.4,0,.2,1)"
    : "none"

  slider.style.transform = `translateX(${-index * window.innerWidth}px)`
  counter.textContent = `${index+1}/${TOTAL}`
  resetTransform()
}

function resetTransform(){
  scale = 1
  panX = panY = 0
  applyTransform()
}

function applyTransform(){
  images[index].style.transform =
    `translate(${panX}px,${panY}px) scale(${scale})`
}

/* ================= NAV ================= */
document.getElementById("next").onclick = ()=>{
  if(index<TOTAL-1){ index++; updateSlider() }
}
document.getElementById("prev").onclick = ()=>{
  if(index>0){ index--; updateSlider() }
}
document.getElementById("close").onclick = ()=>history.back()

document.addEventListener("keydown",e=>{
  if(e.key==="ArrowRight") document.getElementById("next").click()
  if(e.key==="ArrowLeft") document.getElementById("prev").click()
})

/* ================= ZOOM + PAN ================= */
images.forEach(img=>{

  // ZOOM PC
  img.addEventListener("wheel",e=>{
    e.preventDefault()
    const delta = e.deltaY<0 ? .15 : -.15
    scale = Math.min(Math.max(1,scale+delta),4)
    applyTransform()
  },{passive:false})

  // PAN PC
  img.addEventListener("mousedown",e=>{
    if(scale<=1) return
    isPanning=true
    startX=e.clientX-panX
    startY=e.clientY-panY
  })

  window.addEventListener("mousemove",e=>{
    if(!isPanning) return
    panX=e.clientX-startX
    panY=e.clientY-startY
    applyTransform()
  })

  window.addEventListener("mouseup",()=>isPanning=false)

  // PAN MOBILE
  let lastX=0,lastY=0
  img.addEventListener("touchstart",e=>{
    if(e.touches.length===1 && scale>1){
      lastX=e.touches[0].clientX
      lastY=e.touches[0].clientY
    }
  })

  img.addEventListener("touchmove",e=>{
    if(e.touches.length===1 && scale>1){
      const dx=e.touches[0].clientX-lastX
      const dy=e.touches[0].clientY-lastY
      panX+=dx
      panY+=dy
      lastX=e.touches[0].clientX
      lastY=e.touches[0].clientY
      applyTransform()
    }
  })
})

/* ================= SWIPE SLIDE ================= */
let swipeStartX=0
document.addEventListener("touchstart",e=>{
  if(e.touches.length===1) swipeStartX=e.touches[0].clientX
})

document.addEventListener("touchend",e=>{
  const dx=e.changedTouches[0].clientX-swipeStartX
  if(Math.abs(dx)>80){
    dx<0 ? document.getElementById("next").click()
          : document.getElementById("prev").click()
  }
})

updateSlider(false)
</script>

</body>
</html>
