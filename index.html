<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Album Preview</title>

<style>
* { box-sizing: border-box }

body {
  margin: 0;
  background: #000;
  color: #fff;
  font-family: Arial, sans-serif;
  user-select: none;
  overflow: hidden;
}

/* Header */
.header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 50px;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 0 12px;
  background: rgba(0,0,0,0.6);
  z-index: 20;
}

.header img {
  height: 32px;
}

.counter {
  margin-left: auto;
  opacity: 0.8;
}

/* Viewer */
.viewer {
  position: fixed;
  inset: 0;
  background: #000;
  overflow: hidden;
  touch-action: none;
}

.viewer img {
  position: absolute;
  top: 50%;
  left: 50%;
  max-width: 100%;
  max-height: 100%;
  transform: translate(-50%, -50%) scale(1);
  transition: transform 0.35s ease;
  cursor: grab;
}

/* Navigation */
.nav {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-size: 52px;
  color: rgba(255,255,255,0.6);
  cursor: pointer;
  padding: 20px;
  z-index: 10;
}

.nav:hover { color: #fff }

.prev { left: 0 }
.next { right: 0 }

/* Close */
.close {
  position: fixed;
  top: 8px;
  right: 12px;
  font-size: 30px;
  cursor: pointer;
  z-index: 30;
  opacity: 0.8;
}
.close:hover { opacity: 1 }

/* Slide animation */
.slide-next {
  animation: slideNext 0.4s ease;
}
.slide-prev {
  animation: slidePrev 0.4s ease;
}

@keyframes slideNext {
  from { transform: translate(100%, -50%) scale(1); opacity: 0.5 }
  to   { transform: translate(-50%, -50%) scale(1); opacity: 1 }
}

@keyframes slidePrev {
  from { transform: translate(-200%, -50%) scale(1); opacity: 0.5 }
  to   { transform: translate(-50%, -50%) scale(1); opacity: 1 }
}
</style>
</head>

<body oncontextmenu="return false">

<div class="header" id="header">
  <img src="logo.png">
  <div>ALBUM PREVIEW</div>
  <div class="counter" id="counter"></div>
</div>

<div class="viewer" id="viewer">
  <div class="nav prev" onclick="prevImage()">&#9664;</div>
  <img id="img">
  <div class="nav next" onclick="nextImage()">&#9654;</div>
</div>

<div class="close" onclick="exitPreview()">âœ•</div>

<script>
/* ===== CONFIG ===== */
const imageFolder = "images/"
const totalImages = 20

const images = Array.from({ length: totalImages }, (_, i) =>
  imageFolder + String(i + 1).padStart(2, "0") + ".jpg"
)

/* ===== STATE ===== */
let index = 0
let scale = 1
let posX = 0
let posY = 0
let startX = 0
let startY = 0
let isDragging = false
let touchStartX = 0
let lastDistance = 0

const img = document.getElementById("img")
const counter = document.getElementById("counter")
const header = document.getElementById("header")

/* ===== FUNCTIONS ===== */
function updateTransform() {
  img.style.transform =
    `translate(calc(-50% + ${posX}px), calc(-50% + ${posY}px)) scale(${scale})`
}

function showImage(i, dir) {
  img.className = ""
  void img.offsetWidth
  img.src = images[i]
  img.classList.add(dir === "next" ? "slide-next" : "slide-prev")

  scale = 1
  posX = 0
  posY = 0
  updateTransform()

  counter.textContent = `${i + 1} / ${images.length}`
}

function nextImage() {
  index = (index + 1) % images.length
  showImage(index, "next")
}

function prevImage() {
  index = (index - 1 + images.length) % images.length
  showImage(index, "prev")
}

/* ===== FULLSCREEN ===== */
function enterFullscreen() {
  const el = document.documentElement
  if (el.requestFullscreen) el.requestFullscreen()
}

function exitPreview() {
  if (document.fullscreenElement) {
    document.exitFullscreen()
  }
}

/* ===== EVENTS ===== */
document.addEventListener("keydown", e => {
  if (e.key === "ArrowRight") nextImage()
  if (e.key === "ArrowLeft") prevImage()
  if (e.key === "Escape") exitPreview()
})

img.addEventListener("wheel", e => {
  e.preventDefault()
  scale += e.deltaY < 0 ? 0.1 : -0.1
  scale = Math.min(Math.max(1, scale), 4)
  updateTransform()
})

img.addEventListener("mousedown", e => {
  if (scale <= 1) return
  isDragging = true
  startX = e.clientX - posX
  startY = e.clientY - posY
  img.style.cursor = "grabbing"
})

window.addEventListener("mousemove", e => {
  if (!isDragging) return
  posX = e.clientX - startX
  posY = e.clientY - startY
  updateTransform()
})

window.addEventListener("mouseup", () => {
  isDragging = false
  img.style.cursor = "grab"
})

img.addEventListener("touchstart", e => {
  if (e.touches.length === 1) {
    touchStartX = e.touches[0].clientX
    startX = touchStartX - posX
    startY = e.touches[0].clientY - posY
    isDragging = scale > 1
  }
})

img.addEventListener("touchmove", e => {
  if (e.touches.length === 1 && isDragging) {
    posX = e.touches[0].clientX - startX
    posY = e.touches[0].clientY - startY
    updateTransform()
  }

  if (e.touches.length === 2) {
    const dx = e.touches[0].clientX - e.touches[1].clientX
    const dy = e.touches[0].clientY - e.touches[1].clientY
    const dist = Math.sqrt(dx*dx + dy*dy)
    if (lastDistance) {
      scale += (dist - lastDistance) * 0.002
      scale = Math.min(Math.max(1, scale), 4)
      updateTransform()
    }
    lastDistance = dist
  }
})

img.addEventListener("touchend", e => {
  if (e.changedTouches.length === 1 && scale === 1) {
    const dx = e.changedTouches[0].clientX - touchStartX
    if (dx > 60) prevImage()
    if (dx < -60) nextImage()
  }
  lastDistance = 0
  isDragging = false
})

/* ===== INIT ===== */
showImage(index)
setTimeout(enterFullscreen, 300)
</script>

</body>
</html>
