<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Album Preview</title>

<style>
html,body{
  margin:0;
  background:#000;
  font-family:Arial;
  user-select:none;
}

#gallery{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(120px,1fr));
  gap:10px;
  padding:10px;
}

#gallery img{
  width:100%;
  aspect-ratio:1/1;
  object-fit:cover;
  cursor:pointer;
  border-radius:6px;
}

#viewer{
  position:fixed;
  inset:0;
  background:#000;
  display:none;
  overflow:hidden;
  touch-action:none;
}

#slider{
  display:flex;
  height:100%;
  transition:transform .45s cubic-bezier(.4,0,.2,1);
}

.slide{
  width:100vw;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.slide img{
  max-width:100%;
  max-height:100%;
  transform-origin:center;
  cursor:grab;
}

.nav{
  position:fixed;
  top:50%;
  transform:translateY(-50%);
  font-size:48px;
  color:#fff;
  cursor:pointer;
  opacity:.6;
}
#prev{left:10px}
#next{right:10px}

#close{
  position:fixed;
  top:12px;
  right:16px;
  font-size:28px;
  color:#fff;
  cursor:pointer;
}

#counter{
  position:fixed;
  bottom:12px;
  right:16px;
  color:#fff;
  font-size:14px;
}
</style>
</head>

<body>

<div id="gallery"></div>

<div id="viewer">
  <div id="slider"></div>
  <div id="prev" class="nav">◀</div>
  <div id="next" class="nav">▶</div>
  <div id="close">✕</div>
  <div id="counter"></div>
</div>

<script>
const TOTAL=20
const FOLDER="images/"
const gallery=document.getElementById("gallery")
const viewer=document.getElementById("viewer")
const slider=document.getElementById("slider")
const counter=document.getElementById("counter")

let index=0,scale=1,panX=0,panY=0
let isPan=false,startX=0,startY=0
let startDist=0,startScale=1

/* LOAD */
for(let i=1;i<=TOTAL;i++){
  const src=FOLDER+String(i).padStart(2,"0")+".jpg"

  const thumb=document.createElement("img")
  thumb.src=src
  thumb.onclick=()=>openViewer(i-1)
  gallery.appendChild(thumb)

  const slide=document.createElement("div")
  slide.className="slide"
  const img=document.createElement("img")
  img.src=src
  slide.appendChild(img)
  slider.appendChild(slide)
}

const images=document.querySelectorAll(".slide img")

function openViewer(i){
  index=i
  viewer.style.display="block"
  gallery.style.display="none"
  update()
}

function closeViewer(){
  viewer.style.display="none"
  gallery.style.display="grid"
}

function update(){
  slider.style.transform=`translateX(${-index*innerWidth}px)`
  counter.textContent=`${index+1}/${TOTAL}`
  resetTransform()
}

function resetTransform(){
  scale=1;panX=panY=0
  apply()
}

function apply(){
  images[index].style.transform=`translate(${panX}px,${panY}px) scale(${scale})`
}

/* NAV */
document.getElementById("next").onclick=()=>{if(index<TOTAL-1){index++;update()}}
document.getElementById("prev").onclick=()=>{if(index>0){index--;update()}}
document.getElementById("close").onclick=closeViewer

document.addEventListener("keydown",e=>{
  if(viewer.style.display!=="block")return
  if(e.key==="ArrowRight")next.click()
  if(e.key==="ArrowLeft")prev.click()
  if(e.key==="Escape")closeViewer()
})

/* ZOOM + PAN PC */
images.forEach(img=>{
  img.onwheel=e=>{
    e.preventDefault()
    scale+=e.deltaY<0?0.15:-0.15
    scale=Math.min(Math.max(1,scale),4)
    apply()
  }

  img.onmousedown=e=>{
    if(scale<=1)return
    isPan=true
    startX=e.clientX-panX
    startY=e.clientY-panY
  }
})

window.onmousemove=e=>{
  if(!isPan)return
  panX=e.clientX-startX
  panY=e.clientY-startY
  apply()
}
window.onmouseup=()=>isPan=false

/* MOBILE */
viewer.addEventListener("touchstart",e=>{
  if(e.touches.length===1 && scale>1){
    startX=e.touches[0].clientX-panX
    startY=e.touches[0].clientY-panY
  }
  if(e.touches.length===2){
    startDist=Math.hypot(
      e.touches[0].clientX-e.touches[1].clientX,
      e.touches[0].clientY-e.touches[1].clientY
    )
    startScale=scale
  }
})

viewer.addEventListener("touchmove",e=>{
  e.preventDefault()
  if(e.touches.length===1 && scale>1){
    panX=e.touches[0].clientX-startX
    panY=e.touches[0].clientY-startY
    apply()
  }
  if(e.touches.length===2){
    const dist=Math.hypot(
      e.touches[0].clientX-e.touches[1].clientX,
      e.touches[0].clientY-e.touches[1].clientY
    )
    scale=startScale*dist/startDist
    scale=Math.min(Math.max(1,scale),4)
    apply()
  }
},{passive:false})
</script>

</body>
</html>
